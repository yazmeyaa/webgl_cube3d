var x=Object.defineProperty;var F=(r,e,s)=>e in r?x(r,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[e]=s;var a=(r,e,s)=>(F(r,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function s(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(t){if(t.ep)return;t.ep=!0;const n=s(t);fetch(t.href,n)}})();var P=`attribute vec3 a_Position;\r
attribute vec3 a_Color;\r
varying vec3 v_Color;\r
uniform mat4 u_Pmatrix;\r
uniform mat4 u_VMatrix;\r
uniform mat4 u_Mmatrix;

void main() {\r
    gl_Position = u_Pmatrix  * u_VMatrix * u_Mmatrix * vec4(a_Position, 1.0);\r
    v_Color = a_Color;\r
}`,y=`precision mediump float;

varying vec3 v_Color;

void main() {\r
    gl_FragColor = vec4(v_Color, 1.0);\r
}`;const u=new Float32Array([1,0,0,0,1,0,0,0,1,1,1,0,1,0,1.1,0,1,1,1,1,0,1,0,1]),M=new Float32Array([-.8,.8,.8,.8,.8,.8,-.8,-.8,.8,.8,-.8,.8,-.8,.8,-.8,.8,.8,-.8,-.8,-.8,-.8,.8,-.8,-.8]),T=new Uint16Array([0,1,2,1,2,3,0,1,4,4,5,1,4,5,6,5,6,7,1,5,3,3,5,7,0,4,2,2,4,6,2,6,3,3,6,7]);var b=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function E(){var r=new b(16);return b!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function w(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function C(r,e,s){var i=s[0],t=s[1],n=s[2],o,c,l,f,h,d,m,v,A,_,R,p;return e===r?(r[12]=e[0]*i+e[4]*t+e[8]*n+e[12],r[13]=e[1]*i+e[5]*t+e[9]*n+e[13],r[14]=e[2]*i+e[6]*t+e[10]*n+e[14],r[15]=e[3]*i+e[7]*t+e[11]*n+e[15]):(o=e[0],c=e[1],l=e[2],f=e[3],h=e[4],d=e[5],m=e[6],v=e[7],A=e[8],_=e[9],R=e[10],p=e[11],r[0]=o,r[1]=c,r[2]=l,r[3]=f,r[4]=h,r[5]=d,r[6]=m,r[7]=v,r[8]=A,r[9]=_,r[10]=R,r[11]=p,r[12]=o*i+h*t+A*n+e[12],r[13]=c*i+d*t+_*n+e[13],r[14]=l*i+m*t+R*n+e[14],r[15]=f*i+v*t+p*n+e[15]),r}function Y(r,e,s){var i=s[0],t=s[1],n=s[2];return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r[3]=e[3]*i,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*n,r[9]=e[9]*n,r[10]=e[10]*n,r[11]=e[11]*n,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function B(r,e,s){var i=Math.sin(s),t=Math.cos(s),n=e[4],o=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],m=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=n*t+f*i,r[5]=o*t+h*i,r[6]=c*t+d*i,r[7]=l*t+m*i,r[8]=f*t-n*i,r[9]=h*t-o*i,r[10]=d*t-c*i,r[11]=m*t-l*i,r}function S(r,e,s){var i=Math.sin(s),t=Math.cos(s),n=e[0],o=e[1],c=e[2],l=e[3],f=e[8],h=e[9],d=e[10],m=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=n*t-f*i,r[1]=o*t-h*i,r[2]=c*t-d*i,r[3]=l*t-m*i,r[8]=n*i+f*t,r[9]=o*i+h*t,r[10]=c*i+d*t,r[11]=l*i+m*t,r}function U(r,e,s,i,t){var n=1/Math.tan(e/2),o;return r[0]=n/s,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=n,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,t!=null&&t!==1/0?(o=1/(i-t),r[10]=(t+i)*o,r[14]=2*t*i*o):(r[10]=-1,r[14]=-2*i),r}var L=U;class D{constructor(e){a(this,"canvas");a(this,"gl");a(this,"cube");a(this,"matrixes");a(this,"shaders");a(this,"attributesPtr");a(this,"program");a(this,"uniform_Matrixes");a(this,"clicked",!1);a(this,"degX",0);a(this,"degY",0);a(this,"oldX",0);a(this,"oldY",0);if(!e)throw new Error("HTMLCanvasElement is not provided!");const s=e.getContext("webgl");if(!s)throw new Error("Cannot get webgl rendering context!");this.gl=s,this.canvas=e,this.cube=this.createCubeBuffer(),this.matrixes=this.createMatrixes(),this.shaders=this.createShaders(),this.program=this.createProgram(this.shaders.vertex,this.shaders.fragment),this.attributesPtr=this.getAttributesPointers(),this.uniform_Matrixes=this.getMatrixesUniformLocation(),this.setupListeners(),this.play()}getMatrixesUniformLocation(){const e=this.gl,s=e.getUniformLocation(this.program,"u_Pmatrix"),i=e.getUniformLocation(this.program,"u_VMatrix"),t=e.getUniformLocation(this.program,"u_Mmatrix");if(!s||!i||!t)throw new Error("Cannot get uniform locations for matrixes");return{model:t,perspective:s,view:i}}createShaders(){const e=this.createShader("vs"),s=this.createShader("fs");return{vertex:e,fragment:s}}createShader(e){const s=this.gl;let i;if(e==="fs")i=s.createShader(s.FRAGMENT_SHADER);else if(e==="vs")i=s.createShader(s.VERTEX_SHADER);else throw new Error("Unexpected type of shader");if(!i)throw new Error("Error while createing shader");const t=e==="vs"?P:y;if(s.shaderSource(i,t),s.compileShader(i),!s.getShaderParameter(i,s.COMPILE_STATUS))throw new Error("Error while compile shader");return i}setupListeners(){const e=this.canvas,s={touchstart:this.onMouseDown,touchend:this.onMouseUp,touchmove:this.onMouseMove,mousedown:this.onMouseDown,mouseup:this.onMouseUp,mousemove:this.onMouseMove,mouseleave:this.onMouseLeave};for(const i in s){const t=s[i];e.addEventListener(i,t.bind(this))}}onMouseMove(e){if(e instanceof MouseEvent){const s=(e.offsetX-this.oldX)*.016,i=(e.offsetY-this.oldY)*.016;this.oldX=e.offsetX,this.oldY=e.offsetY,this.clicked&&(this.degX+=s,this.degY+=i)}else if(e instanceof TouchEvent){const s=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY,t=(s-this.oldX)*.016,n=(i-this.oldY)*.016;this.oldX=s,this.oldY=i,this.clicked&&(this.degX+=t,this.degY+=n)}}onMouseDown(){this.clicked=!0}onMouseUp(){this.clicked=!1}onMouseLeave(){}createCubeBuffer(){const e=this.gl,s=e.createBuffer(),i=e.createBuffer(),t=e.createBuffer();if(!s||!i||!t)throw new Error("Cannot create buffers for render cube!");return e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,M,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,u,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),e.bufferData(e.ELEMENT_ARRAY_BUFFER,T,e.STATIC_DRAW),{color:s,faces:t,vertexPosition:i}}createMatrixes(){const e=E(),s=E();return{model:E(),perspective:e,view:s}}clearCanvas(){this.gl.clearColor(.6,.6,.6,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT)}createProgram(e,s){const i=this.gl,t=i.createProgram();if(!t)throw new Error("Cannot create program");return i.attachShader(t,e),i.attachShader(t,s),i.linkProgram(t),i.useProgram(t),t}getAttributesPointers(){const e=this.gl,s=this.program,i=e.getAttribLocation(s,"a_Position"),t=e.getAttribLocation(s,"a_Color");return e.enableVertexAttribArray(i),e.enableVertexAttribArray(t),{a_Color:t,a_Position:i}}render(){const e=this.gl;e.enable(e.DEPTH_TEST),this.clearCanvas(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.cube.faces),e.drawElements(e.TRIANGLES,36,e.UNSIGNED_SHORT,0),e.flush()}update(){const e=this.gl,{attributesPtr:s,uniform_Matrixes:i,matrixes:t}=this;w(t.model),w(t.view),L(t.perspective,45,g.width/g.height,.1,100),C(t.view,t.view,[0,0,-2]),S(t.model,t.model,this.degX),B(t.model,t.model,this.degY),Y(t.model,t.model,[.5,.5,.5]),e.uniformMatrix4fv(i.model,!1,t.model),e.uniformMatrix4fv(i.view,!1,t.view),e.uniformMatrix4fv(i.perspective,!1,t.perspective),e.bindBuffer(e.ARRAY_BUFFER,this.cube.vertexPosition),e.bufferData(e.ARRAY_BUFFER,M,e.STATIC_DRAW),e.vertexAttribPointer(s.a_Position,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.cube.color),e.bufferData(e.ARRAY_BUFFER,u,e.STATIC_DRAW),e.vertexAttribPointer(s.a_Color,3,e.FLOAT,!1,0,0)}play(){this.update(),this.render(),window.requestAnimationFrame(this.play.bind(this))}}const g=document.getElementById("canvas");g.width=window.innerWidth;g.height=window.innerHeight;const O=new D(g);console.log(O);
